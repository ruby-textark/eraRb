@calcPalam
#dim dynamic partIdx
	
	; 굴복
	if submissiveParam() > 0
		UP:굴복 += SOURCE:MASTER:피격
	endif

	; 성감 / 욕정
	for partIdx, 101, 200
		if strlens(BASENAME:partIdx) == 0
			continue
		endif

		; 기본적으로 SOURCE를 받아옴
		; ABL 적용
		UP:partIdx += (SOURCE:MASTER:partIdx) * (ABL:MASTER:partIdx + 1)
		
		UP:partIdx *= (ABL:TARGET:기교 + 1)
		
		UP:욕정 += PALAM:MASTER:partIdx / 100
	next

	; 순종
	UP:순종 += power(2, min(submissiveParam() / 2, 20))
	if TALENT:MASTER:겁쟁이
		UP:순종 += SOURCE:MASTER:피격
	endif

	; 기본 사정감 증가
	if TFLAG:이번턴성공격
		; 부위 경험 반영
		if isBodyPart(TFLAG:이번턴성공격)
			PALAM:TARGET:사정 += 900 + MIN(2000, EXP:MASTER:(TFLAG:이번턴성공격))
		; fallback
		else
			PALAM:TARGET:사정 += 900
		endif
	endif

	; 삽입체크
	if CFLAG:MASTER:삽입질 == 1
		if BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50 > 30
			UP:고통 += 1000 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 1000 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
		elseif BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50 > 25
			UP:고통 += 500 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 800 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
		elseif BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50 > 20
			UP:고통 += 200 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 600 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
		elseif BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50 > 10
			UP:고통 += 100 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 400 * (BASE:MASTER:보지조임 + BASE:TARGET:자지크기 - 50)
		endif
	endif

	if CFLAG:MASTER:삽입애널 == 1
		if BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50 > 30
			UP:고통 += 1000 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 1000 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
		elseif BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50 > 25
			UP:고통 += 500 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 800 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
		elseif BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50 > 20
			UP:고통 += 200 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 600 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
		elseif BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50 > 10
			UP:고통 += 100 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
			PALAM:TARGET:사정 += 400 * (BASE:MASTER:애널조임 + BASE:TARGET:자지크기 - 50)
		endif
	endif

	; 조루 처리
	if TALENT:TARGET:조루
		TIMES PALAM:TARGET:사정, 1.5 
	endif
