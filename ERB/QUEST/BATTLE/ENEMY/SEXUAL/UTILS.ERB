@isAttackableBodyPart(partIdx)
#function
#dim dynamic partIdx
#dims dynamic partName

	if strlens(BASENAME:i) == 0
		returnf 0
	endif

	partName = %STR:i%

	; 요도->방광 순
	if partName == "방광" && CFLAG:MASTER:삽입요도 == 0
		returnf 0
	endif
	; 자궁->난소 순
	if partName == "난소" && CFLAG:MASTER:삽입자궁 == 0
		returnf 0
	endif
	; 질->자궁 순
	if partName == "자궁" && CFLAG:MASTER:삽입질 == 0
		returnf 0
	endif
	
	; 상의를 입고 있는 경우
	if partName == "유두" && (EQUIP:MASTER:상의 != 0 || EQUIP:MASTER:속옷 != 0)
		returnf 0
	endif

	; 하의를 입고 있는 경우
	if partName == "질" && (EQUIP:MASTER:하의 != 0 || EQUIP:MASTER:속옷 != 0)
		returnf 0
	endif
	if partName == "애널" && (EQUIP:MASTER:하의 != 0 || EQUIP:MASTER:속옷 != 0)
		returnf 0
	endif

	returnf 1

@getSexualAtkBodyPart
#dim dynamic partsCount
#dim dynamic attackedIdx

	partsCount = 0
	for i, 101, 199
		if isAttackableBodyPart(i)
			partsCount++
		endif
	next
	
	attackedIdx = RAND:partsCount

	partsCount = 0
	for i, 101, 199
		if isAttackableBodyPart(i)
			if partsCount == attackedIdx
				return i
			endif
			partsCount++
		endif
	next

	return -1

@sexualInsert(attackedIdx)
#dim dynamic attackedIdx

	CFLAG:MASTER:(200 + attackedIdx) = 1
	EXP:MASTER:attackedIdx++
